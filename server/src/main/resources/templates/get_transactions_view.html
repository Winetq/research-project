<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Transactions</title>
    <link th:href="@{/styles/main.css}" rel="stylesheet" />
    <script type="text/javascript" th:src="@{/js/index.js}"></script>
    <script th:inline="javascript">
        /*<![CDATA[*/
        var showingQueriesForIndex = /*[[${showingQueriesForIndex}]]*/ -1;
        var transactions = /*[[${transactions}]]*/ [];
        /*]]>*/
    </script>
</head>
<body>
<div class="section">
    <h1>
        Transactions
    </h1>
</div>

<div class="section">
    <table>
        <thead>
        <tr>
            <th>Queries in transaction</th>
            <th>Times [μs]</th>
            <th>Average time [μs]</th>
        </tr>
        </thead>
        <tbody>
        <tr th:if="${transactions}"
            th:each="transaction, trIndex: ${transactions}"
            class="table-row"
            th:id="'row'+${trIndex.index}"
            th:onclick="'showQueries(' + ${trIndex.index} + ')'"
            title="Click to show original queries"
        >
            <td>
                <ul>
                    <li th:each="query: ${transaction.transactionQueries}"
                        th:text="${query}"
                        class="table-row-query"
                    >
                    </li>
                </ul>
            </td>
            <td>
                <div class="table-row-times">
                    <span th:each="time, timeIndex: ${transaction.times}"
                          th:text="${time} + ${timeIndex.index + 1 != timeIndex.size ? ', ' : ''} "
                          class="table-row-time"
                    />
                </div>
            </td>
            <td>
                <div class="table-row-avg-time"
                th:text="${averageTimes[trIndex.index]}"
                />
            </td>
        </tr>
        <tr th:unless="${transactions}">
            <td>No transactions</td>
            <td th:text="${test}"></td>
            <td></td>
        </tr>
        </tbody>
    </table>
</div>
<div class="section">
    <div class="footer">
        <p><i>
            Automated tracking and grouping of database
            transactions in Java Virtual Machine (JVM)
            applications
        </i></p>
        <p>
            A project created for Research Project classes at Gdansk University of Technology
        </p>
    </div>
</div>
</body>
</html>